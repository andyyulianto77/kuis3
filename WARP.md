# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

Repository purpose: a HAXcms static site with custom Lit-based web components bundled via Rollup. Custom components power a quiz experience and optional Google Sheets submission.

Common commands

- Install deps (inside custom/):
  ```sh path=null start=null
  cd custom
  yarn install
  ```
- Watch build (Rollup watch):
  ```sh path=null start=null
  yarn start
  ```
- Build once (outputs build/custom.es6.js):
  ```sh path=null start=null
  yarn build
  ```
- Generate Custom Elements Manifest (for docs/analysis):
  ```sh path=null start=null
  yarn analyze
  ```
- Tests/lint: no test or lint scripts are defined in this repo at time of writing.

Architecture overview

- Site content/layout
  - pages/: HTML per page (HAXcms structure). files/: binary assets referenced by pages. theme/: site theme assets. assets/: legacy browser helpers (build-legacy.js, build-polyfills.js) and upgrade-browser.html.
- Custom components (custom/)
  - Entry: src/custom.js imports and registers all site-specific elements. Rollup config (rollup.config.js) bundles to build/custom.es6.js with esbuild minification and Babel template-literal minify; external() keeps bare imports external so CDN ESM stays unbundled. Windows path handling is accounted for in external resolution.
  - confetti-quiz (custom/src/kuis-confeti.js)
    - LitElement that renders the quiz UI, persists progress in localStorage, and computes score/percentage. Emits two events: quiz-result during progress and quiz-finished at completion. Includes an on-page confetti overlay element (kuis-confeti) with a fire() API.
  - quiz-sheets-sender (custom/src/quiz-sheets-sender.js)
    - LitElement that, when present, listens on window for quiz-finished and POSTs the result/user data to a Google Apps Script Web App endpoint (mode: 'no-cors'). Configured via the web-app-url attribute. Debounces duplicate sends via an internal id.
- CI/CD
  - .github/workflows/main.yml deploys with JamesIves/github-pages-deploy-action. It invokes npm run ghpages:build at repo root; ensure that script exists if you intend to use this workflow as-is.

Google Sheets integration (high level)

See custom/GOOGLE_SHEETS_INTEGRATION.md for full steps. Minimal wiring example:
```html path=null start=null
<confetti-quiz id="quiz"></confetti-quiz>
<quiz-sheets-sender web-app-url="https://script.google.com/macros/s/â€¦/exec"></quiz-sheets-sender>
```
The sender listens for quiz-finished from the quiz component and posts fields: action=tambah, iddata, namaorng, nilai, nope, alamatorng, keterangan.

Important project notes

- Development loop (custom/README.md): run yarn start in custom/ and refresh your HAXcms site to see changes; build for distribution with yarn build.
- The bundle build/custom.es6.js is the only generated artifact under custom/ committed in this workflow; do not hand-edit custom-elements.json as it can be regenerated by yarn analyze.
